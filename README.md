# Moss-chat-web

A minimal TypeScript web application built with Express.js that provides an AI chat interface powered by the GitHub Copilot SDK. This application integrates with GitHub Copilot to provide intelligent responses, enhanced with a local knowledge base for context-aware answers.

## Features

- **Express.js Server**: Minimal TypeScript-based Express.js server
- **AI Chat Interface**: Clean, dark-themed chat interface
- **GitHub Copilot SDK Integration**: Powered by GitHub Copilot for intelligent AI responses
- **Knowledge Base Integration**: Searches local knowledge base to provide context-aware answers
- **Streaming Responses**: Real-time streaming of AI responses via Server-Sent Events (SSE)
- **TypeScript**: Strict type safety throughout the application
- **Linting**: ESLint configured for TypeScript
- **CI/CD**: GitHub Actions workflow for automated testing and building

## Project Structure

```
moss-chat-web/
├── src/
│   ├── server.ts              # Express server with API endpoints
│   ├── copilot-service.ts     # GitHub Copilot SDK wrapper
│   └── knowledge-service.ts   # Knowledge base search service
├── public/
│   └── index.html             # Chat interface UI
├── data/                      # Knowledge base documents
├── .github/
│   └── workflows/
│       └── lint-and-build.yml  # CI/CD pipeline
├── dist/                      # Compiled JavaScript (generated)
├── package.json               # Dependencies and scripts
├── tsconfig.json              # TypeScript configuration
├── .eslintrc.json             # ESLint configuration
└── README.md                  # This file
```

## Prerequisites

- Node.js >= 18.0.0
- npm, pnpm, or yarn
- GitHub Copilot subscription and CLI configured (required for AI functionality)

## Setup

### 1. Clone the repository

```bash
git clone https://github.com/sekka1/Moss-chat-web.git
cd Moss-chat-web
```

### 2. Install dependencies

```bash
npm install
```

### 3. Configure GitHub Copilot

Ensure you have GitHub Copilot CLI installed and authenticated:

```bash
# Login to GitHub Copilot (if not already logged in)
gh copilot login
```

Note: The application requires an active GitHub Copilot subscription. If Copilot is not available, the application will provide fallback responses with knowledge base context.

## Development

### Run in development mode

```bash
npm run dev
```

This starts the server using `ts-node` in development mode.

### Build the application

```bash
npm run build
```

This compiles TypeScript files from `src/` to JavaScript in `dist/`.

### Run in production mode

```bash
npm start
```

This runs the compiled JavaScript from the `dist/` folder.

### Lint the code

```bash
npm run lint
```

To automatically fix linting issues:

```bash
npm run lint:fix
```

### Run tests

```bash
npm test
```

Note: Test infrastructure is minimal at this stage. Tests will be expanded as the application grows.

## Application Usage

1. Start the server using one of the methods above
2. Open your browser to `http://localhost:3000`
3. You'll see the Moss Chat interface with:
   - **Top area**: Displays AI responses and chat history
   - **Bottom area**: Input box for typing questions
4. Type a question and press Enter or click Send
5. The application will use GitHub Copilot SDK to generate intelligent responses, enhanced with relevant information from the knowledge base

## API Endpoints

### POST /api/chat

Send a message to the AI assistant and receive a complete response.

**Request:**
```json
{
  "message": "Your question here"
}
```

**Response:**
```json
{
  "response": "AI response generated by GitHub Copilot SDK"
}
```

### POST /api/chat/stream

Send a message and receive a streaming response via Server-Sent Events (SSE).

**Request:**
```json
{
  "message": "Your question here"
}
```

**Response:** Server-Sent Events stream with chunks:
```
data: {"chunk":"AI response chunk"}

data: {"chunk":"more response..."}

data: [DONE]
```

### GET /api/health

Health check endpoint to verify the server is running.

**Response:**
```json
{
  "status": "ok"
}
```

## GitHub Copilot SDK Integration

This application uses the [GitHub Copilot SDK](https://github.com/github/copilot-sdk) to provide intelligent AI responses. The integration includes:

- **Context-Aware Responses**: Searches the local knowledge base before generating responses to provide more accurate, context-specific answers
- **Streaming Support**: Real-time streaming of responses via Server-Sent Events
- **Model Selection**: Uses GPT-4.1 for high-quality responses
- **Graceful Fallback**: Provides informative fallback responses if Copilot is unavailable

### Documentation Resources

- [GitHub Copilot SDK Documentation](https://github.com/github/copilot-sdk)
- [Node.js Integration Guide](https://github.com/github/awesome-copilot/blob/main/cookbook/copilot-sdk/nodejs/README.md)
- [Copilot SDK Cookbook](https://github.com/github/awesome-copilot/tree/main/cookbook/copilot-sdk)

### How It Works

1. **User Question**: User sends a question via the chat interface
2. **Knowledge Base Search**: The system searches the local `data/` directory for relevant documents
3. **Context Enhancement**: Relevant document snippets are included as context
4. **Copilot Generation**: The GitHub Copilot SDK generates a response using the question and context
5. **Response Display**: The response is returned to the user (streamed or complete)

The main integration points are:
- `src/copilot-service.ts`: Wrapper for GitHub Copilot SDK with initialization and session management
- `src/server.ts`: API endpoints that combine knowledge base search with Copilot responses

## CI/CD Pipeline

The project includes a GitHub Actions workflow that automatically runs on every pull request:

- **Linting**: Ensures code quality and TypeScript standards
- **Building**: Verifies the application compiles successfully
- **Testing**: Runs the test suite
- **Multi-version**: Tests against Node.js 18.x and 20.x

The workflow is defined in `.github/workflows/lint-and-build.yml`.

## Code Quality Standards

This project follows strict TypeScript and code quality standards:

- **TypeScript Strict Mode**: No `any` types without justification
- **ESLint**: Configured for TypeScript with recommended rules
- **JSDoc Comments**: All exported functions include documentation
- **Security**: Input validation and sanitization for user inputs

See [AGENTS.md](./AGENTS.md) and [.github/copilot-instructions.md](./.github/copilot-instructions.md) for detailed coding standards.

## Development Workflow

### Before Every Commit

1. Run linting: `npm run lint`
2. Run build: `npm run build`
3. Run tests: `npm test`
4. Ensure all checks pass

### Pull Request Guidelines

- Include screenshots for any GUI changes
- Ensure CI/CD pipeline passes
- Keep PRs focused on a single concern
- Update documentation for any API changes

## Contributing

1. Follow the TypeScript coding standards in `.github/copilot-instructions.md`
2. Run linting and tests before committing
3. Keep functions small and focused
4. Document exported functions with JSDoc
5. For GUI changes, include screenshots in the PR

## License

MIT

## Tech Stack

- **Runtime**: Node.js
- **Framework**: Express.js
- **Language**: TypeScript
- **Linting**: ESLint
- **CI/CD**: GitHub Actions

## Environment Variables

- `PORT`: Server port (default: 3000)
- GitHub Copilot authentication is handled via the GitHub CLI (`gh copilot login`)

## Security

This application implements security best practices:

- Input validation on API endpoints
- No hardcoded secrets
- Content Security Policy headers ready for implementation
- Safe HTML rendering (no XSS vulnerabilities)

For detailed security guidelines, see [AGENTS.md](./AGENTS.md).
